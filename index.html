<!DOCTYPE html><html><head><meta charset=UTF-8><meta name=viewport content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><title>WebXr 3d model demo</title><script src=https://unpkg.com/three@0.126.0/build/three.js></script><script src=https://unpkg.com/three@0.126.0/examples/js/loaders/GLTFLoader.js></script><script src=https://unpkg.com/three@0.126.0/examples/js/loaders/DRACOLoader.js></script><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx crossorigin=anonymous><script defer=defer src=main.31d6cfe0d16ae931b73c.bundle.js></script></head><body><button type=button class="btn btn-primary" style=position:absolute;top:50%;left:50% onclick=activateXR()>Start AR</button><script>async function activateXR(){const e=document.createElement("canvas");document.body.appendChild(e);const t=e.getContext("webgl",{xrCompatible:!0}),a=new THREE.Scene;let r=new THREE.Clock;var n=new THREE.HemisphereLight(16777215,4473924);n.position.set(0,300,0),a.add(n);var s=new THREE.DirectionalLight(16777215);s.position.set(75,300,0),a.add(s);const i=new THREE.WebGLRenderer({alpha:!0,preserveDrawingBuffer:!0,canvas:e,context:t});i.autoClear=!1;const o=new THREE.PerspectiveCamera;o.matrixAutoUpdate=!1;const c=await navigator.xr.requestSession("immersive-ar",{requiredFeatures:["hit-test"]});c.updateRenderState({baseLayer:new XRWebGLLayer(c,t)});const d=await c.requestReferenceSpace("local"),m=await c.requestReferenceSpace("viewer"),p=await c.requestHitTestSource({space:m}),l=new THREE.GLTFLoader;let u,f,w=new THREE.DRACOLoader;w.setDecoderPath("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/js/libs/draco/"),l.setDRACOLoader(w),l.load("./assets/yastik.glb",(function(e){u=e.scene,u.visible=!1,a.add(u)})),l.load("assets/yastik.glb",(function(e){e.scene;f=e.scene})),function e(){requestAnimationFrame(e);r.getDelta();i.render(a,o)}(),c.addEventListener("select",(e=>{if(f){const e=f.clone();e.position.copy(u.position),a.add(e)}}));const E=(e,r)=>{c.requestAnimationFrame(E),t.bindFramebuffer(t.FRAMEBUFFER,c.renderState.baseLayer.framebuffer);const n=r.getViewerPose(d);if(n){const e=n.views[0],t=c.renderState.baseLayer.getViewport(e);i.setSize(t.width,t.height),o.matrix.fromArray(e.transform.matrix),o.projectionMatrix.fromArray(e.projectionMatrix),o.updateMatrixWorld(!0);const s=r.getHitTestResults(p);if(s.length>0&&u){const e=s[0].getPose(d);u.visible=!0,u.position.set(e.transform.position.x,e.transform.position.y,e.transform.position.z),u.updateMatrixWorld(!0)}i.render(a,o)}};c.requestAnimationFrame(E)}</script></body></html>